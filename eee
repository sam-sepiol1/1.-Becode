# SQL questionnaire

## Setup

Import this [fake database content](mysqlsampledatabase.zip) into your database.

Below you will find a list of questions.

Find out the answer to each question using the dummy data in your database.

**Copy this file** (see: copy raw content) and fill in your queries + answer on the given location in each question.

## START !

### 1) How many customers do we have?
```
<Your SQL query here>
```

```sql
SELECT COUNT(*) FROM customers;
```

### 2) What is the customer number of Mary Young?

```
<Your SQL query here>
```

```sql
SELECT `customerNumber` FROM customers WHERE `contactLastName` = 'Young' AND `contactFirstName` = 'Mary';
```

### 3) What is the customer number of the person living at Magazinweg 7, Frankfurt 60528?

```
<Your SQL query here>
```

```sql
SELECT customerNumber FROM customers WHERE addressLine1 = 'Magazinweg 7' AND city = 'Frankfurt' AND postalCode = '60528';
```

### 4) If you sort the employees on their last name, what is the email of the first employee?

```
<Your SQL query here>
```

```sql
SELECT email FROM employees ORDER BY lastName LIMIT 1;
```

### 5) If you sort the employees on their last name, what is the email of the last employee?

```
<Your SQL query here>
```

```sql
SELECT email FROM employees ORDER BY lastName DESC LIMIT 1;
```

solution: SELECT email FROM employees ORDER BY lastName DESC LIMIT 1;

### 6) What is first the product code of all the products from the line 'Trucks and Buses', sorted first by productscale, then by productname.

```
<Your SQL query here>
```

```sql
SELECT productCode FROM products WHERE productLine = 'Trucks and Buses' ORDER BY productScale, productName;
```

### 7) What is the email of the first employee, sorted on their last name that starts with a 't'?

```
<Your SQL query here>
```

solution: 
```sql
SELECT email
FROM employees
WHERE lastName LIKE 'T%'
ORDER BY lastName
LIMIT 1;
```

### 8) Which customer (give customer number) payed by check on 2004-01-19?

```
<Your SQL query here>
```

```sql
SELECT customerNumber FROM payments WHERE paymentDate = '2004-01-19' AND checkNumber IS NOT NULL;
```

### 9) How many customers do we have living in the state Nevada or New York?

```
<Your SQL query here>
```

solution:

```sql
SELECT COUNT(*) AS customer_count FROM customers WHERE state = 'NV' OR state = 'NY';
```

### 10) How many customers do we have living in the state Nevada or New York or outside the united states?

```
<Your SQL query here>
```

solution:

```sql
SELECT COUNT(*) AS customer_count FROM customers WHERE state = 'NV' OR state = 'NY' OR country <> 'USA';
```

### 11) How many customers do we have with the following conditions (only 1 query needed): - Living in the state Nevada or New York OR - Living outside the USA or the customers and with a credit limit above 1000 dollar?

```
<Your SQL query here>
```

solution:

```sql
SELECT COUNT(*) AS customer_count FROM customers WHERE state = 'NV' OR state = 'NY' OR country <> 'USA' OR `creditLimit` > 1000;
```

### 12) How many customers don't have an assigned sales representative?

```
<Your SQL query here>
```

solution:

```sql
SELECT COUNT(*) AS customer_count FROM customers WHERE `salesRepEmployeeNumber` IS NULL;
```

### 13) How many orders have a comment?

```
<Your SQL query here>
```

solution:

```sql
SELECT COUNT(*) AS order_count FROM orders WHERE comments IS NOT NULL;
```

### 14) How many orders do we have where the comment mentions the word "caution"?

```
<Your SQL query here>
```

solution:

```sql
SELECT COUNT(*) AS order_count FROM orders WHERE comments LIKE '%caution%';
```

### 15) What is the average credit limit of our customers from the USA? (rounded)

```
<Your SQL query here>
```

solution:

```sql
SELECT ROUND(AVG(creditLimit)) AS average_credit_limit
FROM customers
WHERE country = 'USA';
```

### 16) What is the most common last name from our customers?

```
<Your SQL query here>
```

solution:
```sql
SELECT contactLastName, COUNT(*) as count
FROM customers
GROUP BY contactLastName
ORDER BY count DESC
LIMIT 1;
```
### 17) What are valid statuses of the orders?

-   [✅] Resolved

-   [✅] Cancelled

-   [❌] Broken

-   [✅] On Hold

-   [✅] Disputed

-   [✅] In Process

-   [❌] Processing

-   [✅] Shipped

```
<Your SQL query here>
```

solution: 
```sql
SELECT DISTINCT status
FROM orders;
``` 

### 18) In which countries don't we have any customers?

-   [] Austria

-   [] Canada

-   [❌] China

-   [] Germany

-   [❌] Greece

-   [] Japan

-   [] Philippines

-   [❌] South Korea

```
<Your SQL query here>
```

solution: 
```sql
SELECT DISTINCT country
FROM customers
ORDER BY country ASC;
```

### 19) How many orders where never shipped?

```
<Your SQL query here>
```

solution: 
```sql
SELECT COUNT(*) as not_shipped 
FROM orders 
WHERE `shippedDate` is NULL;
```

### 20) How many customers does Steve Patterson have with a credit limit above 100 000 EUR?

```
<Your SQL query here>
```

solution: 
```sql
SELECT COUNT(*) AS customer_count
FROM customers c
JOIN employees e ON c.salesRepEmployeeNumber = e.employeeNumber
WHERE e.firstName = 'Steve' AND e.lastName = 'Patterson' AND c.creditLimit > 100000;
```

### 21) How many orders have been shipped to our customers?

```
<Your SQL query here>
```

solution: 
```sql
SELECT COUNT(*) AS orders_shipped
FROM orders 
WHERE status = 'shipped';
```

### 22) How much products does the biggest product line have? And which product line is that?

```
<Your SQL query here>
```

solution:
```sql
SELECT COUNT(*), productLine
FROM products
GROUP BY productLine
```

### 23) How many products are low in stock? (below 100 pieces)

```
<Your SQL query here>
```

solution: 
```sql
SELECT COUNT(*) AS low_stock
FROM products
WHERE `quantityInStock` < 100;
```

### 24) How many products have more the 100 pieces in stock, but are below 500 pieces.

```
<Your SQL query here>
```

solution: 
```sql
SELECT COUNT(*) AS low_stock
FROM products
WHERE `quantityInStock` > 100 AND `quantityInStock` < 500 ;
```

### 25) How many orders did we ship between and including June 2004 & September 2004

```
<Your SQL query here>
```

solution: 
```sql 
SELECT COUNT(*) AS number_of_orders
FROM orders
WHERE shippedDate BETWEEN '2004-06-01' AND '2004-09-30';
```

### 26) How many customers share the same last name as an employee of ours?

```
<Your SQL query here>
```

solution: 
```sql
SELECT COUNT(DISTINCT c.customerNumber) AS customerCount
FROM customers c
JOIN employees e ON c.contactLastName = e.lastName;
```

### 27) Give the product code for the most expensive product for the consumer?

```
<Your SQL query here>
```

solution: 
```sql
SELECT `productCode`
FROM products 
ORDER BY `buyPrice` DESC LIMIT 1;
```

### 28) What product (product code) offers us the largest profit margin (difference between buyPrice & MSRP).

```
<Your SQL query here>
```

solution:
```sql
SELECT 
    productCode,
    productName
FROM 
    products
ORDER BY (MSRP - buyPrice) DESC;
``` 

### 29) How much profit (rounded) can the product with the largest profit margin (difference between buyPrice & MSRP) bring us.

```
<Your SQL query here>
```

solution: 
```sql
SELECT 
    productCode,
    productName,
    ROUND((MSRP - buyPrice) * quantityInStock, 2) AS totalProfit
FROM 
    products
ORDER BY 
    (MSRP - buyPrice) DESC
LIMIT 1;
```

### 30) Given the product number of the products (separated with spaces) that have never been sold?

```
<Your SQL query here>
```

solution: 
```sql
SELECT COUNT(*) as not_sold
FROM products
WHERE productCode NOT IN (
    SELECT productCode
    FROM orderdetails
);
```

### 31) How many products give us a profit margin below 30 dollar?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 32) What is the product code of our most popular product (in number purchased)?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 33) How many of our popular product did we effectively ship?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 34) Which check number paid for order 10210. Tip: Pay close attention to the date fields on both tables to solve this.

```
<Your SQL query here>
```

solution: `<your solution here>`

### 35) Which order was paid by check CP804873?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 36) How many payments do we have above 5000 EUR and with a check number with a 'D' somewhere in the check number, ending the check number with the digit 9?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 38) In which country do we have the most customers that we do not have an office in?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 39) What city has our biggest office in terms of employees?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 40) How many employees does our largest office have, including leadership?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 41) How many employees do we have on average per country (rounded)?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 42) What is the total value of all shipped & resolved sales ever combined?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 43) What is the total value of all shipped & resolved sales in the year 2005 combined? (based on shipping date)

```
<Your SQL query here>
```

solution: `<your solution here>`

### 44) What was our most profitable year ever (based on shipping date), considering all shipped & resolved orders?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 45) How much revenue did we make on in our most profitable year ever (based on shipping date), considering all shipped & resolved orders?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 46) What is the name of our biggest customer in the USA of terms of revenue?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 47) How much has our largest customer inside the USA ordered with us (total value)?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 48) How many customers do we have that never ordered anything?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 49) What is the last name of our best employee in terms of revenue?

```
<Your SQL query here>
```

solution: `<your solution here>`

### 50) What is the office name of the least profitable office in the year 2004?

```
<Your SQL query here>
```

solution: `<your solution here>`

## Are you done? Amazing!

![](../_assets/clap-clap-clap.gif)


